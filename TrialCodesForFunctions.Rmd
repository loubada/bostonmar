---
title: "FunctionTrialCodes"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Trial Codes For Functions To Test if They Work

You'll find the list of functions being built here before being transformed to the proper package files


## 1. Age Bracket Column Creation
```{r}

library(dplyr)
data_all <- readRDS("data_all.rds")
data_all_dup <- data_all

View(data_all)


#inefficient code, also if statements do not support vectorized input hence need for lapply, no optimised
agebracket <- function(X){
  if (X < 20){
    Y <- "<20"
  } else
    if (20 <= X & X < 25){
      Y <- "20 - 24"
    }
    else
    if (25 <= X & X < 30){
      Y <- "25 - 29"
    }
    else
    if (30 <= X & X < 35){
      Y <- "30 - 34"
    }
    else
    if (35 <= X & X < 40){
      Y <- "35 - 39"
    }
    else
    if (40 <= X & X < 45){
      Y <- "40 - 44"
    }
    else
    if (45 <= X & X < 50){
      Y <- "45 - 49"
    }
    else
    if (50 <= X & X < 55){
      Y <- "50 - 54"
    }
    else
    if (55 <= X & X < 60){
      Y <- "55 - 59"
    }
    else
    if ( X > 60){
      Y <- "> 60"
    }
 print(return(Y))
}

#inefficient code
agebracket2 <- function(age){
  ifelse (age < 20, Y <- "<20",
    ifelse (age < 25, Y <- "20 - 24",
      ifelse (age < 30, Y <- "25 - 29",
        ifelse (age < 35, Y <- "30 - 34",
          ifelse (age < 40, Y <- "35 - 39",
            ifelse (age < 45, Y <- "40 - 44",
              ifelse (age < 50, Y <- "45 - 49",
                ifelse (age < 55, Y <- "50 - 54",
                  ifelse (age < 60, Y <- "55 - 59", Y <- "> 60")))))))))
                          
 print(return(Y))
}

#function to create age brackets based on input value of age
agebracket3 <- function(age){
  ifelse (age < 20, "<20",
    ifelse (age < 25, "20 - 24",
      ifelse (age < 30, "25 - 29",
        ifelse (age < 35, "30 - 34",
          ifelse (age < 40, "35 - 39",
            ifelse (age < 45, "40 - 44",
              ifelse (age < 50, "45 - 49",
                ifelse (age < 55, "50 - 54",
                  ifelse (age < 60, "55 - 59", "> 60")))))))))
}
#testing
agebracket2(22)
agebracket(55)
a <- agebracket3(98)
a
A <- c(1, 50, 23)
B <- lapply(A, agebracket3)
C <- agebracket3(A)
is.vector(C)




#Function to create a new column
agebracketcol <- function(X){
  X["Age_Bracket"] <- X["Age"] %>% agebracket3() %>% as.vector()
  return(X)
}

#testing on duplicated dataset
data_all_dup <- data_all_dup %>% agebracketcol()
unique(data_all_dup$`Age_Bracket`)
View(data_all_dup)
```

## 1. Age Filter - filter data based on input value of age and its corresponding age bracket
```{r}
agefilter <- function(age, dataset){ #input value of age, dataset is the data to be filtered
  agebracket <- age %>% agebracket3()
  dataset <- dataset %>% filter(Age_Bracket == agebracket)
  return(dataset)
}
#mannual testing
ageb <- (29 %>% agebracket3())
data_all_dup_age_29 <- data_all_dup %>% filter(Age_Bracket==ageb)

#testing the function
data_all_dup_age_29 <- agefilter(29, data_all_dup)
unique(data_all_dup_age_29$Age_Bracket)
View(data_all_dup_age_29)
dim(data_all_dup_age_29)



```
